---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

interface Props {
	src: ImageMetadata | string;
	alt: string;
	title?: string;
	subtitle?: string;
	overlay?: boolean;
	overlayOpacity?: number;
	height?: 'small' | 'medium' | 'large' | 'full';
	position?: 'top' | 'center' | 'bottom';
	class?: string;
}

const {
	src,
	alt,
	title,
	subtitle,
	overlay = true,
	overlayOpacity = 50,
	height = 'medium',
	position = 'center',
	class: className = '',
} = Astro.props;

const heightClasses = {
	small: 'h-64 md:h-80',
	medium: 'h-80 md:h-96',
	large: 'h-96 md:h-[32rem]',
	full: 'h-screen',
};

const positionClasses = {
	top: 'items-start pt-16',
	center: 'items-center',
	bottom: 'items-end pb-16',
};

const isImportedImage = typeof src !== 'string';
---

<div class={`relative ${heightClasses[height]} w-full overflow-hidden ${className}`}>
	<!-- Imagen de fondo -->
	{
		isImportedImage ? (
			<Image
				src={src}
				alt={alt}
				class="absolute inset-0 w-full h-full object-cover"
				format="webp"
				quality={85}
			/>
		) : (
			<img
				src={src}
				alt={alt}
				class="absolute inset-0 w-full h-full object-cover"
			/>
		)
	}

	<!-- Overlay oscuro (opcional) -->
	{
		overlay && (
			<div
				class="absolute inset-0 bg-gradient-to-b from-black/40 to-black/60"
				style={`opacity: ${overlayOpacity / 100}`}
			/>
		)
	}

	<!-- Contenido sobre la imagen -->
	{
		(title || subtitle) && (
			<div class={`relative z-10 flex ${positionClasses[position]} justify-center h-full px-4`}>
				<div class="text-center text-white max-w-4xl">
					{title && (
						<h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-4 drop-shadow-lg">
							{title}
						</h1>
					)}
					{subtitle && (
						<p class="text-lg md:text-xl lg:text-2xl drop-shadow-md opacity-90">
							{subtitle}
						</p>
					)}
					<slot />
				</div>
			</div>
		)
	}

	<!-- Slot para contenido personalizado si no hay title/subtitle -->
	{!title && !subtitle && (
		<div class={`relative z-10 flex ${positionClasses[position]} justify-center h-full`}>
			<slot />
		</div>
	)}
</div>
